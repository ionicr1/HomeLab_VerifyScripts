$Quarantine_Folder = '%PATH%'
$Adware_Location = '%PATH%'
$Ransomware_Location = '%PATH%'
$Rootkit_Location = '%PATH%'

$Clam_Scanner = '%PATH% -i --no-summary'
$Clam_Log = 'C:\Program Files\ClamAV\clamd.log'

while ($true) {
    # Case 1: Adware is detected but not cleaned.
    & '%PATH%' -i --no-summary '%PATH%' | %{ "{0:o}: {1} ({2})" -f (Get-Date -format "MMM dd yyyy HH:mm:ss:fff K"), $_, $env:COMPUTERNAME} | Out-File "%PATH%" -Append -Encoding utf8;

    # Case 2: Ransomware detection
    & '%PATH%' -i --no-summary '%PATH%' | %{ "{0:o}: {1} ({2})" -f (Get-Date -format "MMM dd yyyy HH:mm:ss:fff K"), $_, $env:COMPUTERNAME} | Out-File "%PATH%" -Append -Encoding utf8;

    # Case 3: Persistent Rootkit Malware:
    & '%PATH%' -i --remove=yes --no-summary '%PATH%' | %{ "{0:o}: {1} ({2})" -f (Get-Date -format "MMM dd yyyy HH:mm:ss:fff K"), $_, $env:COMPUTERNAME} | Out-File "%PATH%" -Append -Encoding utf8;

    # Copying rootkit back into original path:
    Copy-Item -Path '%PATH%' -Destination '%PATH%';
}
